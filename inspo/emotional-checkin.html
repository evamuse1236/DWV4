<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotional Palette - InnerSpace</title>
    <link rel="stylesheet" href="../css/styles.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        body {
            overflow: hidden;
        }

        .mood-deck::-webkit-scrollbar {
            display: none;
        }

        .mood-deck {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>

<body>

    <!-- Sidebar -->
    <aside class="sidebar" style="z-index: 100;">
        <div
            style="font-family: 'Cormorant Garamond', serif; font-style: italic; font-size: 28px; margin-bottom: 60px; color: #1a1a1a;">
            InnerSpace</div>
        <nav class="flex-col gap-2">
            <a href="dashboard.html" class="nav-link"><i class="ph ph-house"></i> Home</a>
            <a href="checkin.html" class="nav-link active"><i class="ph ph-heart"></i> Check-in</a>
            <a href="sprint.html" class="nav-link"><i class="ph ph-list-checks"></i> Sprint</a>
        </nav>
    </aside>


    <main class="page-wrapper" style="padding-top: 40px;">
        <div class="container" style="max-width: 1600px; text-align: center;">

            <div id="header-text" class="fade-in-up" style="transition: opacity 0.5s; margin-bottom: 20px;">
                <span class="art-subtitle" style="color: #666;">Reflecting</span>
                <h1 style="font-size: 3rem; margin: 0; line-height: 1;">The Palette of Presence</h1>
            </div>

            <div style="position: absolute; top: 40px; right: 60px; z-index: 50;">
                <button class="btn-close-orb" id="reset-btn" onclick="resetDeck()"
                    style="border: none; background: none; font-size: 24px; cursor: pointer; opacity: 0; pointer-events: none; transition: opacity 0.3s;">
                    <i class="ph ph-arrow-left"></i>
                </button>
            </div>

            <!-- PRIMARY CARDS DECK (4 Quadrants) -->
            <div class="mood-deck fade-in-up delay-1" id="main-deck">

                <!-- Good + High Energy -->
                <div class="mood-card primary" id="p-good-high" onclick="expandPalette(this, 'goodHigh')"
                    style="background: #FEF9C3;">
                    <i class="ph-light ph-sun"></i>
                    <div class="orb-label">Good + High<br>Energy</div>
                </div>

                <!-- Good + Low Energy -->
                <div class="mood-card primary" id="p-good-low" onclick="expandPalette(this, 'goodLow')"
                    style="background: #E0F7FA;">
                    <i class="ph-light ph-plant"></i>
                    <div class="orb-label">Good + Low<br>Energy</div>
                </div>

                <!-- Bad + Low Energy -->
                <div class="mood-card primary" id="p-bad-low" onclick="expandPalette(this, 'badLow')"
                    style="background: #E5E7EB;">
                    <i class="ph-light ph-drop"></i>
                    <div class="orb-label">Bad + Low<br>Energy</div>
                </div>

                <!-- Bad + High Energy -->
                <div class="mood-card primary" id="p-bad-high" onclick="expandPalette(this, 'badHigh')"
                    style="background: #FFE4E6;">
                    <i class="ph-light ph-cloud-rain"></i>
                    <div class="orb-label">Bad + High<br>Energy</div>
                </div>
            </div>

            <!-- NUANCE CANVAS (GRID) -->
            <div class="nuance-canvas" id="canvas"></div>

            <!-- Tooltip Element -->
            <div id="tooltip" class="definition-tooltip"></div>

        </div>
    </main>

    <script>
        // 4-Quadrant Data with Definitions
        const shadesData = {
            goodHigh: [ // Yellows (Light -> Saturated)
                { name: 'Excited', color: '#FFFBEB', def: "Feeling super energetic and happy because something fun is about to happen or is happening." },
                { name: 'Curious', color: '#FEF9C3', def: "Recognizing there is something you don't know, and really wanting to learn more about it." },
                { name: 'Proud', color: '#FEF08A', def: "Feeling happy and good about something you did or achieved." },
                { name: 'Playful', color: '#FDE047', def: "Feeling fun, relaxed, and ready to joke around or connect with others." },
                { name: 'Confident', color: '#FCD34D', def: "Believing in yourself and trusting that you can handle a situation." },
                { name: 'Motivated', color: '#F59E0B', def: "Feeling ready and eager to keep trying to reach a goal." }
            ],
            goodLow: [ // Serene Mix (Teals -> Lavenders -> Mints)
                { name: 'Calm', color: '#F0FDF4', def: "Feeling steady and keeping your cool, even when things are busy or stressful." },
                { name: 'Relaxed', color: '#E0F2F1', def: "Feeling loose and free from tension or worry." },
                { name: 'Safe', color: '#E1F5FE', def: "Feeling protected and knowing that the hard part is over." },
                { name: 'Content', color: '#F3E5F5', def: "Feeling happy with what you have and not needing anything else right now." },
                { name: 'Grateful', color: '#FDF2F8', def: "Feeling thankful for the good things and people in your life." },
                { name: 'Peaceful', color: '#F1F8E9', def: "Feeling quiet inside with no pressure to do anything (also called Tranquility)." },
                { name: 'Serene', color: '#FFF7ED', def: "Feeling a deep sense of peace and clear-headedness." }
            ],
            badLow: [ // Blue Hour (Slates -> Dusky Blues -> Fog)
                { name: 'Tired', color: '#F9FAFB', def: "Feeling like you have no energy and need to rest or sleep." },
                { name: 'Bored', color: '#F1F5F9', def: "Feeling restless because you want to do something fun but can't find anything to do." },
                { name: 'Sad', color: '#E0F2FE', def: "Feeling down or unhappy because you lost something or something bad happened." },
                { name: 'Lonely', color: '#EEF2FF', def: "Feeling sad because you want to be with friends or feel close to others, but you aren't." },
                { name: 'Disappointed', color: '#F8FAFC', def: "Feeling let down because something didn't go the way you wanted or hoped." },
                { name: 'Discouraged', color: '#F1F1F1', def: "Losing your energy and belief that you can finish something you started." },
                { name: 'Melancholy', color: '#E2E8F0', def: "A quiet, thoughtful sadness that feels a bit like a rainy day." }
            ],
            badHigh: [ // Warm Pinks (Light -> Rose)
                { name: 'Stressed', color: '#FFF1F2', def: "Feeling like you have too much to do and not enough time or ability to handle it." },
                { name: 'Worried', color: '#FFE4E6', def: "Thinking a lot about bad things that might happen later." },
                { name: 'Nervous', color: '#FECDD3', def: "Feeling shaky or uneasy about something that is about to happen." },
                { name: 'Frustrated', color: '#FFB8C1', def: "Feeling annoyed because something out of your control is stopping you from doing what you want." },
                { name: 'Angry', color: '#FFA6B2', def: "Feeling mad because something isn't fair or is blocking your way." },
                { name: 'Overwhelmed', color: '#FF94A2', def: "Feeling like everything is too much and you can't think or act." }
            ]
        };

        // Add 'Not sure' to all categories
        Object.keys(shadesData).forEach(key => {
            shadesData[key].push({ name: 'Not sure', color: '#FFFFFF', def: "Just checking in, IDK yet." });
        });

        let activeType = null;
        let tooltipTimer = null;

        function expandPalette(card, type) {
            if (activeType === type) return;

            const canvas = document.getElementById('canvas');
            const primaries = document.querySelectorAll('.mood-card.primary');
            const btn = document.getElementById('reset-btn');

            // 1. Shrink primary cards
            primaries.forEach(p => {
                p.classList.add('active-primary');
            });
            document.getElementById('header-text').style.opacity = '0.4';
            btn.style.opacity = '1';
            btn.style.pointerEvents = 'auto';

            // 2. Cross-Fade Logic
            canvas.classList.remove('visible');

            setTimeout(() => {
                activeType = type;
                canvas.innerHTML = '';

                const shades = shadesData[type];
                shades.forEach((shade, idx) => {
                    const tile = document.createElement('div');
                    tile.className = 'shade-tile';
                    tile.style.backgroundColor = shade.color;
                    tile.innerText = shade.name;
                    tile.style.transitionDelay = (idx * 0.03) + 's';

                    // Tooltip Events - Hover based
                    tile.onmouseenter = (e) => startTooltip(e, shade.def);
                    tile.onmouseleave = hideTooltip;

                    // For mobile, a single tap can toggle
                    tile.onclick = (e) => {
                        // Optional: select emotion logic here
                    };

                    canvas.appendChild(tile);
                });

                void canvas.offsetWidth;
                canvas.classList.add('visible');
            }, 400);
        }

        function startTooltip(e, text) {
            clearTimeout(tooltipTimer);
            tooltipTimer = setTimeout(() => {
                const tooltip = document.getElementById('tooltip');
                tooltip.innerText = text;
                tooltip.classList.add('visible');

                // Position logic for Fixed positioning
                const rect = e.target.getBoundingClientRect();
                tooltip.style.left = (rect.left + rect.width / 2) + 'px';
                tooltip.style.top = rect.top + 'px'; // anchored precisely above
            }, 50); // Fast hover response
        }

        function hideTooltip() {
            clearTimeout(tooltipTimer);
            document.getElementById('tooltip').classList.remove('visible');
        }

        function resetDeck() {
            activeType = null;
            const canvas = document.getElementById('canvas');
            const primaries = document.querySelectorAll('.mood-card.primary');
            const btn = document.getElementById('reset-btn');

            canvas.classList.remove('visible');
            primaries.forEach(p => {
                p.classList.remove('active-primary');
            });

            btn.style.opacity = '0';
            btn.style.pointerEvents = 'none';
            document.getElementById('header-text').style.opacity = '1';
        }
    </script>
</body>

</html>